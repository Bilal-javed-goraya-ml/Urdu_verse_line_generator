
# ğŸ­ Urdu Verse Line Generator using Luong Attention

A deep learning-based sequence generation model that generates Urdu poetry (verse lines) using Luong Attention mechanism in an Encoder-Decoder LSTM architecture. This model learns poetic structure from a dataset of **Milli Naghmay & Qawali's** and generates next lines given a starting verse.

## ğŸ“Œ Features

- Seq2Seq architecture with Luong-style attention
- Trained on Urdu national songs (Milli Naghmay)
- Web interface using Gradio
- Generates next verse(s) based on input line
- CLI and web-based prediction
- Clean modular codebase (train, predict, evaluate)

---

## ğŸ—‚ï¸ Project Structure

```
Luong_Attention_Udru_task/
â”œâ”€â”€ app.py                     # Gradio web interface
â”œâ”€â”€ main.py                    # Entry point for training, prediction, data creation
â”œâ”€â”€ models/                    # Encoder, Decoder, Attention, train and predict scripts
â”œâ”€â”€ utils/                     # Preprocessing, vocabulary handling, helpers
â”œâ”€â”€ dataset/                   # Raw .txt files of milli naghme (each line is a masra)
â”œâ”€â”€ data/                      # Processed train/val/test CSVs and vocab files
â”œâ”€â”€ trained/                   # Trained PyTorch model (.pt)
â”œâ”€â”€ images/                    # Training loss plot
â””â”€â”€ README.md
```

---

## âš™ï¸ Installation

```bash
git clone https://github.com/Bilal-javed-goraya-ml/Urdu_verse_line_generator.git
cd Urdu_verse_line_generator

# (Recommended) Create and activate a virtual environment
conda create -n env python=3.12 -y
conda activate env

# Install dependencies

pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cu121
pip install -r requirements.txt
```

---

## ğŸ§  Training the Model

1. **Prepare the dataset (split + vocab):**

```bash
python main.py --mode data-builder
```

2. **Train the model:**

```bash
python main.py --mode train
```

> Trained model will be saved in `trained/model.pt`

---

## ğŸ”® Predict from CLI

```bash
python main.py --mode predict
```

You will be prompted to enter a verse line in Urdu. The model will generate the next line(s) interactively.

---

## ğŸŒ Run Web App (Gradio)

```bash
python app.py
```

This will launch a beautiful Gradio interface at `http://localhost:1102` where you can:

- Enter an initial verse
- Select number of iterations (lines to generate)
- Get poetic continuation generated by the model

---

## ğŸ“Š Sample Output

Input:
```
Ú©Ø§Ù„ÛŒ Ú©Ø§Ù„ÛŒ Ø²Ù„ÙÙˆÚº Ú©Û’ Ù¾Ú¾Ù†Ø¯Û’ Ù†Û ÚˆØ§Ù„Ùˆ
```

Generated:
```
ÛÙ…ÛŒÚº Ø²Ù†Ø¯Û Ø±ÛÙ†Û’ Ø¯Ùˆ Ø§Û’ Ø­Ø³Ù† ÙˆØ§Ù„Ùˆ
Ù†Û Ú†Ú¾ÛŒÚ‘Ùˆ ÛÙ…ÛŒÚºØŒ ÛÙ… Ø³ØªØ§Ø¦Û’ ÛÙˆØ¦Û’ ÛÛŒÚº
Ø¨ÛØª Ø²Ø®Ù… Ø³ÛŒÙ†Û’ Ù¾Û Ú©Ú¾Ø§Ø¦Û’ ÛÙˆØ¦Û’ ÛÛŒÚº
```

---

## ğŸ“ˆ Visuals

<p align="center">
  <img src="images/test.png" width="1000" />
</p>

<p align="center">
  <img src="images/test1.png" width="1000" />
</p>

<p align="center">
  <img src="images/test2.png" width="1000" />
</p>

---

## ğŸ› ï¸ Customization

- Add more `.txt` files of Urdu poems/songs in `dataset/`
- Run `data-builder` mode again
- Retrain model for better results

---

## â¤ï¸ Credits

Developed with passion for Urdu poetry ğŸ‡µğŸ‡°

> Inspired by the beauty and rhythm of **Milli Naghmay & Qawali's** and the creativity of AI.

## ğŸ“œ License

MIT License. Feel free to use and modify for educational or research purposes.